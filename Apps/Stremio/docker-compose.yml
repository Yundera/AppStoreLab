name: stremio

services:
  stremio:
    image: ghcr.io/yundera/nginx-hash-lock:latest
    container_name: stremio
    restart: unless-stopped
    user: "root"
    expose:
      - 80
    environment:
      AUTH_HASH: $AUTH_HASH
      USER: "admin"
      PASSWORD: "stremio"
      SESSION_DURATION_HOURS: "720"
      BACKEND_HOST: "stremiocommunity"
      BACKEND_PORT: "8080"
      LISTEN_PORT: "80"
      ALLOWED_EXTENSIONS: "js,css,png,jpg,jpeg,gif,ico,svg,woff,woff2,ttf,eot,webp,map,json,wasm,html,m3u8,ts,mp4"
      ALLOWED_PATHS: ""
    tmpfs:
      - /var/cache/nginx:size=50M
    depends_on:
      - stremiocommunity
    networks:
      - pcs
    x-casaos:
      envs:
        - container: USER
          description:
            en_us: "Login username"
        - container: PASSWORD
          description:
            en_us: "Login password"
        - container: SESSION_DURATION_HOURS
          description:
            en_us: "Session duration in hours (default: 720 = 30 days)"

  stremiocommunity:
    image: tsaridas/stremio-docker:latest
    container_name: stremiocommunity
    restart: unless-stopped
    user: "0:0"
    environment:
      NO_CORS: "1"
      AUTO_SERVER_URL: "1"
    volumes:
      - type: bind
        source: /DATA/AppData/stremio/server
        target: /root/.stremio-server
    networks:
      - pcs
    x-casaos:
      volumes:
        - container: /root/.stremio-server
          description:
            en_us: "Stremio server data and configuration"

networks:
  pcs:
    external: true

x-casaos:
  architectures:
    - amd64
    - arm64
    - arm/v7
  main: stremio
  author: Yundera
  developer: Yundera
  icon: https://www.stremio.com/website/stremio-logo-small.png
  tagline:
    en_us: "Stream movies & series (Community Edition)"
  category: Entertainment
  description:
    en_us: |
      Stremio Community Edition with NGINX Hash Lock authentication.

      Features:
      - Clean login page (username/password)
      - Direct link access with ?hash= parameter
      - 30-day session duration
      - Clean subdomain (no port prefix)
      - All-in-one streaming server with FFmpeg transcoding

      Default credentials: admin / stremio
      Change via environment variables on the "stremio" service.

      This setup uses the tsaridas/stremio-docker community image
      which bundles Stremio Server, Web UI, and FFmpeg in a single
      optimized container. NGINX Hash Lock provides authentication
      while allowing internal streaming to work without interference.
  title:
    en_us: "Stremio"
  store_app_id: stremio
  is_uncontrolled: false
  index: /
  webui_port: 80
  tips:
    before_install:
      en_us: |
        Access: `https://${REF_DOMAIN}/` login: `admin` / `stremio`

        You can change USER/PASSWORD via environment variables on "stremio" service, by default:
        • USER: admin
        • PASSWORD: stremio

        You can find Stremio addons in the Stremio Addon Catalog: https://addons.strem.io/
        Or search for "Stremio addons" online for more options.

        Stremio Addons provide access to various streaming sources, including movies, series, TV channels, and more.
